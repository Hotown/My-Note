# 反向代理服务器

## 一、概述

`反向代理(Reverse Proxy)`方式是指以代理服务器来接受Internet上的连接请求，然后将请求转发给内部网络上的服务器；并将从服务器上得到的结果返回给Internet上请求连接的客户端，此时代理服务器对外就表现为一个服务器。

通常的代理服务器，只用于代理内部网络对Internet的连接请求，客户机必须指定代理服务器,并将本来要直接发送到Web服务器上的http请求发送到代理服务器中。当一个代理服务器能够代理外部网络上的主机，访问内部网络时，这种代理服务的方式称为反向代理服务。

## 二、反向代理服务器的工作原理

1. **做内容服务器的替身**

    可通过反向代理服务器，实现客户端与内容服务器的隔离
    
    如果内容服务器中具有涉及安全的敏感信息，可在内容服务器的防火墙之外，设置一个反向代理服务器，作为内容服务器的替身。
    
    客户端向站点发起请求时，请求将被转到代理服务器，代理服务器通过防火墙（对代理服务器设置有权访问）的指定通路，将请求发送给内容服务器。同样，内容服务器将通过防火墙，将响应发送给代理服务器，由代理服务器向客户端发送响应。如果内容服务器返回错误消息，代理服务器会先行截取该消息并更改标头中列出的任何 URL，然后再将消息发送给客户机。如此可防止外部客户机获取内部内容服务器的重定向 URL。
    
    可见，反向代理服务器在客户端眼中，就是内容服务器。然而在实际的请求过程中，反向代理服务器在安全数据库与恶意攻击之间设立了第二道屏障。

2. **作为内容服务器的负载均衡器**

    可以在一个组织内使用多个代理服务器来平衡各 Web 服务器间的网络负载。在此模型中，可以利用代理服务器的高速缓存特性，创建一个用于负载平衡的服务器池。此时，代理服务器可以位于防火墙的任意一侧。如果 Web 服务器每天都会接收大量的请求，则可以使用代理服务器分担 Web 服务器的负载并提高网络访问效率。
    
    对于客户机发往真正服务器的请求，代理服务器起着中间调停者的作用。代理服务器会将所请求的文档存入高速缓存。如果有不止一个代理服务器，DNS 可以采用`循环复用法`选择其 IP 地址，随机地为请求选择路由。客户机每次都使用同一个 URL，但请求所采取的路由每次都可能经过不同的代理服务器。
    
    可以使用多个代理服务器来处理对一个高用量内容服务器的请求，这样做的好处是内容服务器可以处理更高的负载，并且比其独自工作时更有效率。在初始启动期间，代理服务器首次从内容服务器检索文档，此后，对内容服务器的请求数会大大下降。



